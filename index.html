<!DOCTYPE html>
<html>
<head>
    <title>LinkedIn Auth Bridge</title>
    <meta http-equiv="refresh" content="1">
</head>
<body>
    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const code = urlParams.get('code');
        const state = urlParams.get('state');
        const error = urlParams.get('error');
        const authType = urlParams.get('auth_type') || 'REGISTER';
        
        // Extraer flavor del state (formato: "flavor_AUTH_TYPE_uniqueId")
        let flavor = 'professional';
        if (state) {
            const stateParts = state.split('_');
            if (stateParts.length >= 3) {
                flavor = stateParts[0]; // El primer elemento es el flavor
            }
        }
        
        let scheme = 'rezuapp://';
        if (flavor === 'user') {
            scheme = 'rezuappuser://';
        }
        
        console.log("Flavor detectado:", flavor);
        console.log("Scheme usado:", scheme);
        console.log("State original:", state);
        
        if (code) {
            window.location.href = scheme + 'callback?code=' + code + 
                                  '&state=' + state + 
                                  '&auth_type=' + authType;
        } else if (error) {
            window.location.href = scheme + 'callback?error=' + error + 
                                  '&state=' + state + 
                                  '&auth_type=' + authType;
        } else {
            document.write('Esperando respuesta de LinkedIn...');
        }
    </script>
</body>
</html>
